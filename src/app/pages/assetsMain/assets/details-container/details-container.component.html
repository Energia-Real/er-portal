
<div class="spinner-container" *ngIf="showLoader">
  <mat-spinner class="custom-spinner" diameter="60"></mat-spinner>
</div>

<div class="home-main-container" *ngIf="!showLoader">
  <div class="home-header-container">
    <app-return-bar></app-return-bar>
    <div class="info-asset-container pt-3">
      <h1>{{assetData?.siteName || '-'}}</h1>
        <p class="fw-medium">Dirección aproximada: <span  *ngIf="addressPlace else notData">{{addressPlace}}</span></p>
    </div>

    <div class="info-weather-container">
      <div class="weather-flex-container">

        <div class="card-weather-container" [ngStyle]="{'background-color': weatherData?.color}">
          <span *ngIf="loadingWeather" class="loader m-auto" matTooltip="Cargando..."></span>

          <div *ngIf="!loadingWeather">
            <div *ngIf="weatherData else notData">
              <i class="mb-2" [ngClass]="weatherCode[weatherData.weatherCode].icon"></i>
              <p>{{weatherData.temperature | number:'1.1-1'}}°C {{weatherCode[weatherData.weatherCode].text}}</p>
            </div>
          </div>
        </div>

        <div class="card-weather-container card-weather-center">
          <span *ngIf="loadingTimeZone" class="loader" matTooltip="Cargando..."></span>

          <div *ngIf="!loadingTimeZone">
            <div *ngIf="timeZonePlace else notData">
              <p>Hora local</p>
              <p class="card-value">{{ timeZonePlace }}</p>
            </div>
          </div>
        </div>

        <div class="card-weather-container card-weather-center">
          <span *ngIf="loadingSystem" class="loader" matTooltip="Cargando..."></span>

          <div *ngIf="!loadingSystem">
            <div *ngIf="dataRespoSystem else notData">
              <p>Tamaño del sistema</p>
              <p class="card-value">{{ dataRespoSystem.total_power | number:'1.2-2' }}</p>
            </div>
          </div>
        </div>
        

        <div class="card-weather-container card-status-system" [ngStyle]="{ 'background-color': dataRespoSystem?.real_health_state == 'healthy' ? '#a1efef' : '#efa1a1' }">
          <span *ngIf="loadingSystem" class="loader" matTooltip="Cargando..."></span>

          <div *ngIf="!loadingSystem">
            <div *ngIf="dataRespoSystem else notData">
              <i *ngIf="dataRespoSystem.real_health_state == 'healthy'" class="fa-solid fa-check mb-2"></i>
              <i *ngIf="dataRespoSystem.real_health_state != 'healthy'" class="fa-solid fa-xmark mb-2"></i>
              <p>Sistema</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="home-tabs-main-container">
    <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" [selectedIndex]="1">

      <mat-tab label="Overview">
        <app-overview-details *ngIf="assetData" [notData]="showNotdata" [assetData]="assetData"></app-overview-details>
      </mat-tab>

      <mat-tab label="Site details">
        <app-site-details *ngIf="assetData" [notData]="showNotdata" [assetData]="assetData"></app-site-details>
      </mat-tab>
   
      <mat-tab label="Site performance">
        <app-site-performance *ngIf="assetData" [assetData]="assetData"></app-site-performance>
      </mat-tab>

      <mat-tab label="FAQ">En desarrollo...</mat-tab>

    </mat-tab-group>
  </div>
</div>

<ng-template #notData>
  <div class="no-data-found">
    <span matTooltip="La información no pudo ser cargada.">-</span>
  </div>
</ng-template>