<mat-spinner *ngIf="showLoader"></mat-spinner>
<div class="px-16 pt-16 assets-main-container" *ngIf="!showLoader">
  <div class="mb-8 assets-header-container">
    <div class="grid grid-cols-2 gap-4">
      <div class="px-8 py-4 rounded-3xl border-2">
        <h2 class="text-er-orange text-base font-normal">Plantas totales</h2>
        <div class="grid grid-cols-4 gap-4 text-center">
          <div class="border-r-2 ">
            <h3 class="text-3xl">{{ dataSummary.noOfSites }}</h3>
            <p class="text-sm"># de sitios</p>
          </div>
          <div class="border-r-2">
            <h3 class="text-3xl">{{ dataSummary.noOfInverters }}</h3>
            <p class="text-sm"># de inversores</p>
          </div>
          <div class="border-r-2">
            <h3 class="text-3xl">{{ dataSummary.mWhInstalled | number:'1.2-2' }}</h3>
            <p class="text-sm">MW instalados</p>
          </div>
          <div>
            <h3 class="text-3xl">{{dataSummary.co2T}}</h3>
            <p class="text-sm">Co2 T</p>
          </div>
        </div>
      </div>
      <div class="">
        <form class="relative w-80 ms-auto">
          <label class="search-icon">
            <img src="./assets/icons/search.svg" alt="Icon Search">
          </label>
          <input class="mt-1 block w-full rounded-full pl-9 h-9" type="text" placeholder="Buscar por nombre de sitio"
            [(ngModel)]="searchValue" [ngModelOptions]="{ standalone: true }" (input)="searchData()">
        </form>
      </div>
    </div>
  </div>
  <div>
    <div>
      <table mat-table [dataSource]="dataSource" class="table-assets">

        <ng-container matColumnDef="siteName">
          <th mat-header-cell *matHeaderCellDef> Nombre del sitio </th>
          <td mat-cell *matCellDef="let element" class="font-semibold"> {{ element.siteName }} </td>
        </ng-container>

        <ng-container matColumnDef="clientId">
          <th mat-header-cell *matHeaderCellDef> Id </th>
          <td mat-cell *matCellDef="let element"> {{ element.clientId || '-' }} </td>
        </ng-container>

        <ng-container matColumnDef="commissionDate">
          <th mat-header-cell *matHeaderCellDef> Fecha de comisión </th>
          <td mat-cell *matCellDef="let element"> {{element.commissionDate}} </td>
        </ng-container>

        <ng-container matColumnDef="inverterQty">
          <th mat-header-cell *matHeaderCellDef> # de inversores </th>
          <td mat-cell *matCellDef="let element"> {{element.inverterQty}} </td>
        </ng-container>

        <ng-container matColumnDef="systemSize">
          <th mat-header-cell *matHeaderCellDef> Tamaño de sistema </th>
          <td mat-cell *matCellDef="let element"> {{element.systemSize}} </td>
        </ng-container>

        <ng-container matColumnDef="googleMapAdress">
          <th mat-header-cell *matHeaderCellDef> Dirección </th>
          <td mat-cell *matCellDef="let element">
            <a [href]="element.googleMapAdress" target="_blank">
              {{element.googleMapAdress}}
            </a>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <button mat-icon-button [matMenuTriggerFor]="menu"><mat-icon>more_vert</mat-icon></button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item (click)="navigate('/assets/edit/' + element.id)">Edit</button>
              <button mat-menu-item (click)="navigate('/assets/details/' + element.id)">Details</button>
            </mat-menu>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="tr-table-assets"></tr>
      </table>

      <mat-paginator
        [length]="totalItems"
        [pageSize]="pageSize"
        [pageSizeOptions]="itemsPerPageOptions"
        (page)="getServerData($event)" 
        showFirstLastButtons
        aria-label="Select page of periodic elements">
      </mat-paginator>
    </div>
  </div>
</div>